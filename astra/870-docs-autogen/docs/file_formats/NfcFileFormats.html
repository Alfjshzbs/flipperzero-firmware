<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NFC Flipper File Formats &mdash; Flipper Zero Firmware  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="File Formats for Flipper’s SubGhz Subsystem" href="SubGhzFileFormats.html" />
    <link rel="prev" title="LF RFID key file format" href="LfRfidFileFormat.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Flipper Zero Firmware
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../doxygen/html/index.html">Auto-generated</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Flipper Zero File Formats</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="BadUsbScriptFormat.html">BadUSB File Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="iButtonFileFormat.html">iButton key file format</a></li>
<li class="toctree-l2"><a class="reference internal" href="InfraredFileFormats.html">Infrared Flipper File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="LfRfidFileFormat.html">LF RFID key file format</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NFC Flipper File Formats</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#nfc-a-uid-header">NFC-A (UID) + Header</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#description">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mifare-ultralight-ntag">Mifare Ultralight/NTAG</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mifare-classic">Mifare Classic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mifare-desfire">Mifare DESFire</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mifare-classic-dictionary">Mifare Classic Dictionary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">Description</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#emv-resources">EMV resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">Description</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SubGhzFileFormats.html">File Formats for Flipper’s SubGhz Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="SubGhzFileFormats.html#subghz-configuration-files">SubGhz configuration files</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../AppManifests.html">Flipper Application Manifests (.fam)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AppsOnSDCard.html">FAP (Flipper Application Package)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fbt.html">Flipper Build Tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FuriHalDebugging.html">Furi HAL Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../HardwareTargets.html">Targets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../KeyCombo.html">Key Combos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../KeyCombo.html#alternative-ways-to-recover-your-device">Alternative ways to recover your device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../LFRFIDRaw.html">Reading RAW RFID data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OTA.html">Executing code from RAM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../RoadMap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UnitTests.html">Unit tests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UniversalRemotes.html">Universal Remotes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GeneratingDocs.html">Generating documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Flipper Zero Firmware</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Flipper Zero File Formats</a></li>
      <li class="breadcrumb-item active">NFC Flipper File Formats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/file_formats/NfcFileFormats.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nfc-flipper-file-formats">
<h1>NFC Flipper File Formats<a class="headerlink" href="#nfc-flipper-file-formats" title="Permalink to this heading"></a></h1>
<section id="nfc-a-uid-header">
<h2>NFC-A (UID) + Header<a class="headerlink" href="#nfc-a-uid-header" title="Permalink to this heading"></a></h2>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Filetype: Flipper NFC device
Version: 3
# Nfc device type can be UID, Mifare Ultralight, Mifare Classic, Bank card
Device type: UID
# UID, ATQA and SAK are common for all formats
UID: 04 85 92 8A A0 61 81
ATQA: 00 44
SAK: 00
</pre></div>
</div>
</section>
<section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading"></a></h3>
<p>This file format is used to store the UID, SAK and ATQA of a NFC-A device. It does not store any internal data, so it can be used for multiple different card types. Also used as a header for other formats.</p>
<p>Version differences:</p>
<ol class="arabic simple">
<li><p>Initial version, deprecated</p></li>
<li><p>LSB ATQA (e.g. 4400 instead of 0044)</p></li>
<li><p>MSB ATQA (current version)</p></li>
</ol>
<p>UID can be either 4 or 7 bytes long. ATQA is 2 bytes long. SAK is 1 byte long.</p>
</section>
</section>
<section id="mifare-ultralight-ntag">
<h2>Mifare Ultralight/NTAG<a class="headerlink" href="#mifare-ultralight-ntag" title="Permalink to this heading"></a></h2>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Filetype: Flipper NFC device
Version: 3
# Nfc device type can be UID, Mifare Ultralight, Mifare Classic
Device type: NTAG216
# UID, ATQA and SAK are common for all formats
UID: 04 85 90 54 12 98 23
ATQA: 00 44
SAK: 00
# Mifare Ultralight specific data
Data format version: 1
Signature: 1B 84 EB 70 BD 4C BD 1B 1D E4 98 0B 18 58 BD 7C 72 85 B4 E4 7B 38 8E 96 CF 88 6B EE A3 43 AD 90
Mifare version: 00 04 04 02 01 00 13 03
Counter 0: 0
Tearing 0: 00
Counter 1: 0
Tearing 1: 00
Counter 2: 0
Tearing 2: 00
Pages total: 231
Pages read: 231
Page 0: 04 85 92 9B
Page 1: 8A A0 61 81
Page 2: CA 48 0F 00
...
Page 224: 00 00 00 00
Page 225: 00 00 00 00
Page 226: 00 00 7F BD
Page 227: 04 00 00 E2
Page 228: 00 05 00 00
Page 229: 00 00 00 00
Page 230: 00 00 00 00
Failed authentication attempts: 0
</pre></div>
</div>
</section>
<section id="id2">
<h3>Description<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>This file format is used to store the UID, SAK and ATQA of a Mifare Ultralight/NTAG device. It also stores the internal data of the card, the signature, the version, and the counters. The data is stored in pages, just like on the card itself.</p>
<p>The “Signature” field contains the reply of the tag to the READ_SIG command. More on that can be found here: <a class="reference external" href="https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf">https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf</a> (page 31)</p>
<p>The “Mifare version” field is not related to the file format version but to the Mifare Ultralight version. It contains the response of the tag to the GET_VERSION command. More on that can be found here: <a class="reference external" href="https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf">https://www.nxp.com/docs/en/data-sheet/MF0ULX1.pdf</a> (page 21)</p>
<p>Other fields are the direct representation of the card’s internal state. Learn more about them in the same datasheet.</p>
<p>Version differences:</p>
<ol class="arabic simple">
<li><p>Current version</p></li>
</ol>
</section>
</section>
<section id="mifare-classic">
<h2>Mifare Classic<a class="headerlink" href="#mifare-classic" title="Permalink to this heading"></a></h2>
<section id="id3">
<h3>Example<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Filetype: Flipper NFC device
Version: 3
# Nfc device type can be UID, Mifare Ultralight, Mifare Classic
Device type: Mifare Classic
# UID, ATQA and SAK are common for all formats
UID: BA E2 7C 9D
ATQA: 00 02
SAK: 18
# Mifare Classic specific data
Mifare Classic type: 4K
Data format version: 2
# Mifare Classic blocks, &#39;??&#39; means unknown data
Block 0: BA E2 7C 9D B9 18 02 00 46 44 53 37 30 56 30 31
Block 1: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 2: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 3: FF FF FF FF FF FF FF 07 80 69 FF FF FF FF FF FF
Block 4: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 5: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 6: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 7: FF FF FF FF FF FF FF 07 80 69 FF FF FF FF FF FF
...
Block 238: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 239: FF FF FF FF FF FF FF 07 80 69 FF FF FF FF FF FF
Block 240: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 241: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 242: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 243: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 244: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 245: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 246: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 247: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 248: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 249: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 250: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 251: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 252: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 253: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 254: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
Block 255: FF FF FF FF FF FF FF 07 80 69 FF FF FF FF FF FF
</pre></div>
</div>
</section>
<section id="id4">
<h3>Description<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<p>This file format is used to store the NFC-A and Mifare Classic specific data of a Mifare Classic card. Aside from the NFC-A data, it stores the card type (1K/4K) and the internal data of the card. The data is stored in blocks, there is no sector grouping. If the block’s data is unknown, it is represented by ‘??’. Otherwise, the data is represented as a hex string.</p>
<p>Version differences:</p>
<ol class="arabic simple">
<li><p>Initial version, has Key A and Key B masks instead of marking unknown data with ‘??’.</p></li>
</ol>
<p>Example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>...
Data format version: 1
# Key map is the bit mask indicating valid key in each sector
Key A map: 000000000000FFFF
Key B map: 000000000000FFFF
# Mifare Classic blocks
...
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Current version</p></li>
</ol>
</section>
</section>
<section id="mifare-desfire">
<h2>Mifare DESFire<a class="headerlink" href="#mifare-desfire" title="Permalink to this heading"></a></h2>
<section id="id5">
<h3>Example<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Filetype: Flipper NFC device
Version: 3
# Nfc device type can be UID, Mifare Ultralight, Mifare Classic
Device type: Mifare DESFire
# UID, ATQA and SAK are common for all formats
UID: 04 2F 19 0A CD 66 80
ATQA: 03 44
SAK: 20
# Mifare DESFire specific data
PICC Version: 04 01 01 12 00 1A 05 04 01 01 02 01 1A 05 04 2F 19 0A CD 66 80 CE ED D4 51 80 31 19
PICC Free Memory: 7520
PICC Change Key ID: 00
PICC Config Changeable: true
PICC Free Create Delete: true
PICC Free Directory List: true
PICC Key Changeable: true
PICC Max Keys: 01
PICC Key 0 Version: 00
Application Count: 1
Application IDs: 56 34 12
Application 563412 Change Key ID: 00
Application 563412 Config Changeable: true
Application 563412 Free Create Delete: true
Application 563412 Free Directory List: true
Application 563412 Key Changeable: true
Application 563412 Max Keys: 0E
Application 563412 Key 0 Version: 00
Application 563412 Key 1 Version: 00
Application 563412 Key 2 Version: 00
Application 563412 Key 3 Version: 00
Application 563412 Key 4 Version: 00
Application 563412 Key 5 Version: 00
Application 563412 Key 6 Version: 00
Application 563412 Key 7 Version: 00
Application 563412 Key 8 Version: 00
Application 563412 Key 9 Version: 00
Application 563412 Key 10 Version: 00
Application 563412 Key 11 Version: 00
Application 563412 Key 12 Version: 00
Application 563412 Key 13 Version: 00
Application 563412 File IDs: 01
Application 563412 File 1 Type: 00
Application 563412 File 1 Communication Settings: 00
Application 563412 File 1 Access Rights: EE EE
Application 563412 File 1 Size: 256
Application 563412 File 1: 13 37 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
</pre></div>
</div>
</section>
<section id="id6">
<h3>Description<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<p>This file format is used to store the NFC-A and Mifare DESFire specific data of a Mifare DESFire card. Aside from the NFC-A data, it stores the card type (DESFire) and the internal data of the card. The data is stored per-application, and per-file. Here, the card was written using those pm3 commands:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>hf mfdes createapp --aid 123456 --fid 2345 --dfname astra
hf mfdes createfile --aid 123456 --fid 01 --isofid 0001 --size 000100
hf mfdes write --aid 123456 --fid 01 -d 1337
</pre></div>
</div>
<p>Version differences:
None, there are no versions yet.</p>
</section>
</section>
<section id="mifare-classic-dictionary">
<h2>Mifare Classic Dictionary<a class="headerlink" href="#mifare-classic-dictionary" title="Permalink to this heading"></a></h2>
<section id="id7">
<h3>Example<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Key dictionary from https://github.com/ikarus23/MifareClassicTool.git

# More well known keys!
# Standard keys
FFFFFFFFFFFF
A0A1A2A3A4A5
D3F7D3F7D3F7
000000000000

# Keys from mfoc
B0B1B2B3B4B5
4D3A99C351DD
1A982C7E459A
AABBCCDDEEFF
714C5C886E97
587EE5F9350F
A0478CC39091
533CB6C723F6
8FD0A4F256E9
...
</pre></div>
</div>
</section>
<section id="id8">
<h3>Description<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<p>This file contains a list of Mifare Classic keys. Each key is represented as a hex string. Lines starting with ‘#’ are ignored as comments. Blank lines are ignored as well.</p>
</section>
</section>
<section id="emv-resources">
<h2>EMV resources<a class="headerlink" href="#emv-resources" title="Permalink to this heading"></a></h2>
<section id="id9">
<h3>Example<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Filetype: Flipper EMV resources
Version: 1
# EMV currency code: currency name
0997: USN
0994: XSU
0990: CLF
0986: BRL
0985: PLN
0984: BOV
...
</pre></div>
</div>
</section>
<section id="id10">
<h3>Description<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<p>This file stores a list of EMV currency codes, country codes, or AIDs and their names. Each line contains a hex value and a name separated by a colon and a space.</p>
<p>Version differences:</p>
<ol class="arabic simple">
<li><p>Initial version</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="LfRfidFileFormat.html" class="btn btn-neutral float-left" title="LF RFID key file format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SubGhzFileFormats.html" class="btn btn-neutral float-right" title="File Formats for Flipper’s SubGhz Subsystem" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Flipper Devices.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: astra/870-docs-autogen
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Branches</dt>
      <dd><a href="NfcFileFormats.html">astra/870-docs-autogen</a></dd>
      <dd><a href="../../../docs-branches-test/index.html">astra/docs-branches-test</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>